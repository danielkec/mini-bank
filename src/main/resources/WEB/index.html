<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Mini Tiny Bank</title>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <link rel="stylesheet" type="text/css" href="main.css">
</head>
<body>
<h1>Mini Tiny Bank</h1>

<table class="account-table">
    <tbody id="account-table"></tbody>
</table>

<form>
    <label for="from">From:</label>
    <input type="text" id="from" name="from"><br><br>
    <label for="to">To:</label>
    <input type="text" id="to" name="to"><br><br>
    <label for="amount">Amount:</label>
    <input type="text" id="amount" name="Amount" value="100"><br><br>
    <input type="submit" id="submit" value="Submit">
</form>


<script>
    const accountTable = $("#account-table");
    const submit = $("#submit");
    const from = $("#from");
    const to = $("#to");
    const amount = $("#amount");

    reloadAccounts();

    submit.click(function () {
        fetch('/transaction/transfer', {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({"from": from.val(), "to": to.val(), "amount": amount.val()})
        })
    });

    function reloadAccounts() {
        fetch('/account', {
            method: 'GET'
        }).then(res => {
            return res.json();
        }).then(accs => {
            for (let account of accs) {
                accountTable.append(`<td class="seat-cell">
                            <div>${account.number}</div>
                            <div class="seat-label">${account.balance}</div>
                          </td>`)
            }
        })
    }
</script>

</body>
</html>